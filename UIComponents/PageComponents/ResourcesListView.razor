@using Models.Resources
@using MediatR
@using Mediator.Mediator.Contracts
@using Radzen
@using Radzen.Blazor
@inject IMediator Mediator
@inject NavigationManager NavManager

<RadzenStack Gap="20px">
    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.SpaceBetween">
        <RadzenText Text="Resources" TextStyle="TextStyle.H4" />
        <RadzenButton Text="New Resource" Icon="add_circle" Click="@(() => NavManager.NavigateTo("/Resources/Create"))" />
    </RadzenStack>

    <RadzenDataGrid Data="@resources" TItem="DataResource" AllowPaging="true" PageSize="10">
        <Columns>
            <RadzenDataGridColumn TItem="DataResource" Property="Name" Title="Name" />
            <RadzenDataGridColumn TItem="DataResource" Property="SchemaKey" Title="Schema" />
            <RadzenDataGridColumn TItem="DataResource" Property="SchemaVersion" Title="Version" Width="80px" />
            <RadzenDataGridColumn TItem="DataResource" Property="UpdatedAt" Title="Updated At">
                <Template Context="res">
                    @((res.UpdatedAt ?? res.CreatedAt).ToLocalTime().ToString("g"))
                </Template>
            </RadzenDataGridColumn>
            <RadzenDataGridColumn TItem="DataResource" Title="Actions" Width="100px">
                <Template Context="res">
                    <RadzenButton Icon="edit" Text="Open" Size="ButtonSize.Small" Click="@(() => NavManager.NavigateTo($"/Resources/Edit/{res.Id}"))" />
                </Template>
            </RadzenDataGridColumn>
        </Columns>
    </RadzenDataGrid>
</RadzenStack>

@code {
    [Parameter] public List<DataResource> resources { get; set; } = new();
}
